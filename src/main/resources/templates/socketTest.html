<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket JWT</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"></script>
</head>
<body>
<h1>WebSocket JWT Test</h1>
<div>
    <label for="jwtToken">JWT Token:</label>
    <input type="text" id="jwtToken" placeholder="Enter JWT Token">
</div>
<button id="connectBtn">Connect</button>
<div>
    <h3>Status:</h3>
    <pre id="status"></pre>
</div>

<script>
    let stompClient;

    document.getElementById('connectBtn').addEventListener('click', () => {
        const jwtToken = document.getElementById('jwtToken').value;

        if (!jwtToken) {
            alert('Please enter a JWT token!');
            return;
        }

        // WebSocket 연결 설정
        const socket = new SockJS('http://localhost:8081/websocket');
        stompClient = Stomp.over(socket);

        // 서버와 연결 (헤더에 JWT 토큰 포함)
        stompClient.connect(
            { Authorization: `Bearer ${jwtToken}` }, // JWT 토큰을 헤더에 추가
            (frame) => {
                console.log('Connected: ' + frame);
                document.getElementById('status').textContent = 'Connected to WebSocket server!';
            },
            (error) => {
                console.error('Connection error: ', error);
                document.getElementById('status').textContent = 'Connection failed!';
            }
        );
    });
</script>
</body>
</html>
